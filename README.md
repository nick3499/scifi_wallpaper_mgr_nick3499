# scifi_wallpaper_mgr_nick3499
Python3: SciFi Wallpaper Manager: csv.reader(), datetime, shlex.split(), subprocess.run(), click

This repo has been made available under the open source [MIT](https://opensource.org/licenses/MIT) license.

![screen capture](screen_capture.png)

Application tested using:
- Linux 5.4.0-14-generic
- Ubuntu 20.04 (Focal Fossa, dev branch)
- Python 3.8.2rc1
- GNU Bash 5.0.11 (x86_64-pc-linux-gnu)

Methods used:
- csv.reader()
- datetime.datetime.now().day
- shlex.split()
- subprocess.run()
- click.command(), option(), group(), echo()

## __init__.py

A Python application root directory should contain an empty `__init__.py` file which basically indicates that the application is a Python module.

## img/

One thing missing from this repo is an application subdirectory which contains **at least** 31 image files which are used as wallpaper images day by day. This repo features the cyberpunk genre.

## help

```shell
$ python3 scifi_wallpaper.py --help
```

The Bash string above will print command line help to the terminal emulator.

## click.group(), click.option(), click.command()

```python
@click.group()
@click.option('--background/--no-background', default=False)
def scifi_wallpaper(background):
    ...

@scifi_wallpaper.command()
def center():
    ...

@scifi_wallpaper.command()
def tile():
    ...

@scifi_wallpaper.command()
def artists():
    ...
```

- `click.group()` decorator method is used to group similar methods. For this app, it will group three other methods with the `scifi_wallpaper()` method.
- `click.option()` decorator method makes the `--background` command line option available.
- `@scifi_wallpaper.command()` decorators are used to bind three methods to `scifi_wallpaper()` as commands.

`click` facilitates the execution of specific methods as commands in the command line:

- `$ python3 scifi_wallpaper.py --background center` sets the background wallpaper image as centered.
- `$ python3 scifi_wallpaper.py --background tile` sets the wallpaper to tile mode.
- `$ python3 scifi_wallpaper.py --background artists` prints a list of artists from a CSV database.

## Image Name Database

### .getlist

`csv/img.csv` is generated by sourcing the `.getlist` shell script which creates the database by redirecting stdout `$ ls img > img.csv` then checking status with `date` to compare its moment of creation.

```shell
$ . .getlist
```

```shell
#! /bin/sh

ls img > csv/img.csv
sudo chown 1000:1000 csv/img.csv
sudo chmod 700 csv/img.csv
printf "\033[1;34mFile status:\033[0m\n"
stat csv/img.csv | grep Change
printf "\033[1;34mCurrent date:\033[0m\n"
date
```

`.getlist` prints something similar to the terminal emulator:

```shell
File status:
Change: 2020-02-23 17:20:54.515495972 -0600
Current date:
Sun 23 Feb 2020 05:20:54 PM CST
```

## with open()

```python
    image_database = 'csv/img.csv'
    with open(image_database) as _file:
        _reader = reader(_file)
        specific_row = [row for i, row in enumerate(_reader, 1)
                        if i == (datetime.now().day)]
        click.echo(f"wallpaper file: \x1b[0;36m{specific_row[0][0]}\x1b[0m")

    cli_args = 'gsettings set org.gnome.desktop.background picture-uri \
file:///home/foo/scripts/scifi_wallpaper/img/' + specific_row[0][0]
    cli_args_list = split(cli_args)
    run(cli_args_list)
```

`image_database` has `csv/img.csv` assigned to it, which is then passed as an argument to the `with open()` definition. And the resulting file I/O is passed to the CSV reader method. `specific_row` contains the image filename which corresponds with the current month's day number of the month. `click.echo()` method (basically a `print()` call) prints the current image's filename to the terminal emulator. A command line string for setting the background image is passed to the `cli_args` variable, which in turn is passed to the `shlex.split()` method which splits the string into a list of individual command line strings, which is finally passed to the subprocess.run() method, followed by the command line.

## Standalone Application

```python
if __name__ == '__main__':
    scifi_wallpaper()
```

That `if` statement will call the `scifi_wallpaper()` method if the application runs as a standalone app. But if it were to be imported into another module, its `__name__` would no longer be `__main__` and it would need to be called with using dot syntax to link it: `scifi_wallpaper.scifi_wallpaper()`.

## .sfwall

As an option, a shell script can be added to a directory on the path to execute the script.

```shell
#! /bin/sh

/bin/python3 /home/foo/scripts/scifi_wallpaper/scifi_wallpaper.py --background $1
```

Then the application can be executed with one of the following:

- `$ .sfwall center`
- `$ .sfwall tile`
- `$ .sfwall artists`
